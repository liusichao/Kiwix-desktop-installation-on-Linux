在Windows 10系统环境下使用Shell GPT（具体指开源工具**shell_gpt**），需遵循以下步骤及配置方法：

### **1. 安装与基础配置**
- **安装方式**：
  - **pip安装**：打开命令提示符或PowerShell，执行：
    ```bash
    pip install shell-gpt
    ```
    安装后首次运行需配置OpenAI API密钥，密钥将自动存储在`%USERPROFILE%\.config\shell_gpt\.sgptrc`文件中。
  - **源码安装**：从Git仓库克隆项目（如`git clone https://gitcode.com/gh_mirrors/sh/shell_gpt`），进入目录后执行`pip install .`。

- **环境要求**：
  - Python 3.8及以上版本。
  - 支持PowerShell（推荐）和CMD环境，自动识别当前Shell类型。

### **2. 配置管理**
- **API密钥设置**：
  - 运行`sgpt "Hello, World!"`，按提示输入OpenAI API密钥。
  - 手动编辑配置文件：在`%USERPROFILE%\.config\shell_gpt\.sgptrc`中添加`OPENAI_API_KEY=你的密钥`。

- **环境变量配置**（可选）：
  - 临时设置（PowerShell示例）：
    ```bash
    $env:DEFAULT_MODEL = "gpt-4o"
    $env:REQUEST_TIMEOUT = "30"
    ```
  - 永久设置：通过Windows系统属性或PowerShell脚本添加用户/系统环境变量。

- **配置文件详解**：
  - 支持自定义模型、超时时间、输出格式等，例如：
    ```ini
    DEFAULT_MODEL = gpt-4o
    REQUEST_TIMEOUT = 60
    PRETTIFY_MARKDOWN = true
    ```

### **3. 基本使用示例**
- **生成Shell命令**：
  ```bash
  sgpt -s "列出当前目录所有txt文件，按大小排序"
  ```
  工具将自动生成并执行PowerShell命令，如：
  ```bash
  Get-ChildItem -Filter *.txt | Sort-Object Length -Descending
  ```

- **代码生成**：
  ```bash
  sgpt --code "用Python解决Fizz Buzz问题"
  ```
  返回可执行的Python代码片段。

- **文档生成**：
  ```bash
  sgpt "分析当前目录结构，生成markdown格式文件树，排除node_modules和.git目录"
  ```
  工具调用内部函数生成结构化文档。

### **4. 高级功能与集成**
- **跨平台同步**：
  - 自定义角色和函数可通过复制`roles`和`functions`目录实现多设备同步。
  - 支持与Ollama等本地大模型集成，需配置`API_BASE_URL`指向本地服务地址。

- **Shell深度集成**：
  - 在PowerShell中，可通过快捷键（如Ctrl+L）触发命令自动补全或转换。
  - 支持Zsh/Bash的实时交互模式，提升命令行效率。

### **5. 常见问题解决**
- **API密钥无效**：检查密钥是否正确，并确保网络可访问OpenAI服务。
- **函数调用失败**：验证自定义函数路径和依赖是否正确，如`execute_shell_command`函数需确保命令语法无误。
- **缓存问题**：清除缓存或禁用缓存选项（`--no-cache`）。

### **6. 注意事项**
- **权限与安全**：确保以管理员权限运行涉及系统操作的命令，避免敏感信息泄露。
- **模型选择**：根据需求选择在线（OpenAI）或本地模型（如Ollama），平衡性能与隐私。
- **更新与维护**：定期检查项目更新，通过`pip install --upgrade shell-gpt`升级版本。

通过以上步骤，用户可在Windows 10环境下高效利用shell_gpt实现命令行自动化、代码生成及文档处理等任务，显著提升开发效率。
