在 `shell_gpt`（SGPT）的 REPL 模式下，临时会话的日志或记录默认保存在用户配置目录下的缓存文件中，具体路径为 `~/.cache/shell_gpt/chat`（或通过配置文件自定义的 `CHAT_CACHE_PATH`）。以下是详细说明：

### **1. 默认存储路径**
- **核心配置项**：  
  REPL 会话的缓存行为由配置文件 `~/.config/shell_gpt/.sgptrc` 中的 `CHAT_CACHE_PATH` 参数控制，默认值为 `~/.cache/shell_gpt/chat`。
- **文件结构**：  
  每个会话会生成独立的 JSON 文件，文件名通常为会话的唯一标识符（如 `temp_session_xxxx`），存储对话历史、角色定义和上下文信息。

### **2. 自定义存储路径**
- **修改配置文件**：  
  在 `~/.config/shell_gpt/.sgptrc` 中添加或修改以下内容：
  ```ini
  [DEFAULT]
  CHAT_CACHE_PATH = /path/to/your/custom/directory
  ```
- **临时覆盖路径**：  
  启动 REPL 时通过命令行参数指定：
  ```bash
  sgpt --repl --chat-cache-path /tmp/my_chat_logs
  ```

### **3. 会话管理命令**
- **列出所有会话**：  
  ```bash
  sgpt --chat-list
  ```
  输出示例：
  ```
  Session ID          Path
  temp_20250918_1234  ~/.cache/shell_gpt/chat/temp_20250918_1234.json
  ```
- **恢复指定会话**：  
  ```bash
  sgpt --repl --chat-id temp_20250918_1234
  ```

### **4. 清理缓存**
- **手动删除**：  
  直接清理缓存目录：
  ```bash
  rm -rf ~/.cache/shell_gpt/chat/*
  ```
- **自动清理**：  
  通过 `cron` 任务定期删除旧文件（如保留最近 30 天）：
  ```bash
  0 0 * * * find ~/.cache/shell_gpt/chat -type f -mtime +30 -delete
  ```

### **5. 安全建议**
- **敏感信息保护**：  
  避免在会话中输入密码、API 密钥等敏感数据，或使用独立会话 ID 隔离重要操作：
  ```bash
  sgpt --repl --chat-id secure_session
  ```
- **加密存储**：  
  对缓存目录启用磁盘加密（如 Linux 的 `ecryptfs` 或 `LUKS`）。

### **6. 调试与验证**
- **检查缓存键生成逻辑**：  
  SGPT 使用输入参数的 MD5 哈希作为缓存键，代码位于 `sgpt/cache.py`：
  ```python
  key = md5(json.dumps((args[1:], kwargs)).encode("utf-8")).hexdigest()
  ```
- **验证缓存写入**：  
  启动 REPL 后执行命令，检查缓存文件是否更新：
  ```bash
  ls -lh ~/.cache/shell_gpt/chat/  # 确认文件修改时间
  ```
